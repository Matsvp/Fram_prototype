<!doctype html>
<html lang="no">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FRAM – Prototype: enklere billettkjøp</title>
  <style>
    :root{
      --bg:#F5F7FA;
      --card:#FFFFFF;
      --text:#111827;
      --muted:#6B7280;
      --line:#E5E7EB;
      --accent:#1F7A8C;     /* aksentfarge */
      --accent2:#0B4F5B;
      --warn:#B45309;
      --ok:#047857;
      --shadow: 0 10px 25px rgba(17,24,39,.08);
      --radius:18px;
      --radius2:14px;
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      --sans: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:var(--sans);
      background: radial-gradient(1200px 500px at 50% -100px, rgba(31,122,140,.15), transparent 60%), var(--bg);
      color:var(--text);
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    .wrap{
      width:min(980px, 100%);
      display:grid;
      grid-template-columns: 1fr;
      gap:18px;
      align-items:start;
      justify-items:center;
    }

    .topbar{
      width: min(980px, 100%);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:10px 12px;
      background: rgba(31,122,140,.10);
      border:1px solid rgba(31,122,140,.20);
      border-radius:999px;
      font-size:13px;
      color: var(--accent2);
      box-shadow: 0 4px 10px rgba(31,122,140,.08);
    }
    .badge b{font-weight:700}

    .helper{
      width:min(980px,100%);
      display:grid;
      grid-template-columns: 1fr;
      gap:12px;
      padding:14px 16px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.7);
      border-radius: var(--radius2);
    }
    .helper h3{
      margin:0;
      font-size:14px;
      color:#0f172a;
      letter-spacing:.2px;
    }
    .helper p{
      margin:0;
      font-size:13px;
      color:var(--muted);
      line-height:1.35;
    }
    .helper .row{
      display:flex; gap:10px; flex-wrap:wrap;
      font-size:12px; color:var(--muted);
    }
    .chip{
      background:#fff;
      border:1px solid var(--line);
      padding:7px 10px;
      border-radius:999px;
    }

    /* Phone frame */
    .phone{
      width: 390px; /* iPhone-ish */
      max-width: 92vw;
      border-radius: 34px;
      background: #0b1220;
      padding: 12px;
      box-shadow: 0 30px 70px rgba(17,24,39,.25);
      position:relative;
    }
    .screen{
      background: var(--bg);
      border-radius: 26px;
      overflow:hidden;
      min-height: 760px;
      display:flex;
      flex-direction:column;
    }

    .appHeader{
      background: #FFFFFF;
      border-bottom: 1px solid var(--line);
      padding: 14px 16px 12px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
    }
    .logo{
      width:34px; height:34px; border-radius:12px;
      background: linear-gradient(135deg, var(--accent), #53B7C5);
      box-shadow: 0 10px 18px rgba(31,122,140,.22);
    }
    .brandText{
      display:flex; flex-direction:column; line-height:1.05;
    }
    .brandText b{font-size:14px}
    .brandText span{font-size:12px; color:var(--muted)}
    .iconBtn{
      border:1px solid var(--line);
      background:#fff;
      border-radius: 12px;
      padding: 8px 10px;
      cursor:pointer;
      font-size:12px;
      color:#111827;
    }
    .iconBtn:active{transform: translateY(1px)}
    .content{
      padding: 14px 16px 120px;
      display:flex;
      flex-direction:column;
      gap:12px;
      flex:1;
    }

    .card{
      background: var(--card);
      border:1px solid var(--line);
      border-radius: var(--radius);
      padding: 14px;
      box-shadow: var(--shadow);
    }
    .card h2{
      margin:0 0 6px;
      font-size:16px;
      letter-spacing:.2px;
    }
    .muted{color:var(--muted)}
    .small{font-size:12px}
    .row{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
    }
    .col{display:flex; flex-direction:column; gap:6px}
    .divider{
      height:1px;
      background: var(--line);
      margin: 10px 0;
    }

    .input{
      display:flex;
      flex-direction:column;
      gap:6px;
      margin-top:8px;
    }
    label{font-size:12px; color:var(--muted)}
    input, select{
      width:100%;
      padding: 12px 12px;
      border-radius: 14px;
      border:1px solid var(--line);
      background:#fff;
      font-size:14px;
      outline:none;
    }
    input:focus, select:focus{
      border-color: rgba(31,122,140,.55);
      box-shadow: 0 0 0 4px rgba(31,122,140,.12);
    }

    .primary{
      background: var(--accent);
      color:#fff;
      border:1px solid rgba(0,0,0,.05);
      border-radius: 16px;
      padding: 12px 14px;
      cursor:pointer;
      font-weight:650;
      font-size:14px;
      box-shadow: 0 16px 30px rgba(31,122,140,.22);
    }
    .primary:active{transform: translateY(1px)}
    .secondary{
      background:#fff;
      color:#111827;
      border:1px solid var(--line);
      border-radius: 16px;
      padding: 12px 14px;
      cursor:pointer;
      font-weight:600;
      font-size:14px;
    }

    .pill{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      border:1px solid var(--line);
      background:#fff;
      font-size:12px;
      color:var(--muted);
    }
    .pill b{color:#111827}

    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(31,122,140,.10);
      border:1px solid rgba(31,122,140,.18);
      font-size:12px;
      color: var(--accent2);
      font-weight:650;
      width:fit-content;
    }

    .steps{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      margin-top:8px;
    }
    .step{
      padding:8px 10px;
      border:1px dashed rgba(31,122,140,.35);
      background: rgba(31,122,140,.06);
      border-radius: 14px;
      font-size:12px;
      color:#0b3d45;
    }

    .bottomBar{
      position:absolute;
      left:12px; right:12px; bottom:12px;
      background: rgba(255,255,255,.94);
      border:1px solid var(--line);
      border-radius: 22px;
      padding: 10px;
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:space-between;
      box-shadow: 0 20px 50px rgba(17,24,39,.18);
      backdrop-filter: blur(8px);
    }
    .bottomBar .mini{
      display:flex; flex-direction:column; gap:2px;
    }
    .bottomBar .mini b{font-size:13px}
    .bottomBar .mini span{font-size:12px; color:var(--muted)}
    .toast{
      background: rgba(17,24,39,.92);
      color:#fff;
      border-radius: 16px;
      padding: 10px 12px;
      font-size: 12px;
      position: fixed;
      top: 18px;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      pointer-events:none;
      transition: opacity .25s ease;
      max-width: 92vw;
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
    }
    .toast.show{opacity:1}
    .kpi{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:8px;
    }
    .kpi .box{
      border:1px solid var(--line);
      border-radius: 16px;
      background:#fff;
      padding:10px;
    }
    .kpi .box b{font-size:13px}
    .kpi .box span{display:block; margin-top:2px; font-size:12px; color:var(--muted)}
    .ok{color:var(--ok); font-weight:700}
    .warn{color:var(--warn); font-weight:700}

    .mono{font-family:var(--mono)}
    .hidden{display:none !important;}

    /* Desktop layout helper */
    @media (min-width: 900px){
      .wrap{grid-template-columns: 430px 1fr; justify-items:start;}
      .helper{position:sticky; top:18px}
      .topbar{grid-column: 1 / -1;}
    }
  </style>
</head>
<body>
  <div class="toast" id="toast">Lagret</div>

  <div class="wrap">
    <div class="topbar">
      <div class="badge"><b>Prototype</b> · FRAM billettkjøp (for sporadiske)</div>
      <button class="iconBtn" id="resetBtn" title="Start på nytt">↺ Reset</button>
    </div>

    <div class="phone" aria-label="Mobilprototype">
      <div class="screen">
        <div class="appHeader">
          <div class="brand">
            <div class="logo" aria-hidden="true"></div>
            <div class="brandText">
              <b>FRAM</b>
              <span id="headerSubtitle">Reise & billett</span>
            </div>
          </div>
          <button class="iconBtn" id="helpBtn">Hjelp</button>
        </div>

        <div class="content" id="viewRoot"></div>
      </div>

      <div class="bottomBar" id="bottomBar">
        <div class="mini">
          <b id="bbTitle">Ingen billett valgt</b>
          <span id="bbSub">Start med å søke reise</span>
        </div>
        <button class="primary" id="bbCta" disabled>Fortsett</button>
      </div>
    </div>

    <div class="helper">
      <h3>Hva dere kan teste med denne prototypen</h3>
      <p>
        Målet er å se om sporadiske reisende klarer å kjøpe riktig billett uten å forstå soner/regler.
        Bruk 4–6 deltakere og mål: tid, feilvalg og usikkerhet.
      </p>
      <div class="row">
        <span class="chip">Oppgave: “Kjøp billett for turen din”</span>
        <span class="chip">Mål: &lt; 60 sek</span>
        <span class="chip">Spør: “Hvor trygg er du (1–5)?”</span>
      </div>
      <div class="row">
        <span class="chip">Fokus: Smart forslag</span>
        <span class="chip">Fokus: Soneforklaring 1 linje</span>
        <span class="chip">Fokus: Trygg utsjekk</span>
      </div>
    </div>
  </div>

  <script>
    // ---- Simple state machine prototype (no frameworks) ----
    const $ = (id) => document.getElementById(id);

    const state = {
      view: "search", // search | suggestion | checkout | ticket
      from: "Molde trafikkterminal",
      to: "Ålesund sentrum",
      time: "Nå",
      passenger: "Voksen",
      ticket: null, // {name, price, zones, validFor, why}
      payment: "Vipps",
      ticketActiveAt: null
    };

    const ticketsCatalog = [
      {
        id: "single_a-b",
        name: "Enkeltbillett",
        price: 44,
        zones: "Sone A–B",
        validFor: "Gyldig i 60 min",
        why: "Passer for én tur mellom Molde og Ålesund.",
        confidence: "Høy treff"
      },
      {
        id: "daypass_ab",
        name: "24-timersbillett",
        price: 119,
        zones: "Sone A–B",
        validFor: "Gyldig i 24 t",
        why: "Lønner seg hvis du skal reise flere ganger i dag.",
        confidence: "Alternativ"
      }
    ];

    function toast(msg){
      const t = $("toast");
      t.textContent = msg;
      t.classList.add("show");
      setTimeout(()=>t.classList.remove("show"), 1500);
    }

    function formatTimeNow(){
      const d = new Date();
      const hh = String(d.getHours()).padStart(2,'0');
      const mm = String(d.getMinutes()).padStart(2,'0');
      return `${hh}:${mm}`;
    }

    function setBottomBar({title, sub, ctaText, enabled, onClick}){
      $("bbTitle").textContent = title;
      $("bbSub").textContent = sub;
      const btn = $("bbCta");
      btn.textContent = ctaText;
      btn.disabled = !enabled;
      btn.onclick = onClick || null;
    }

    function headerSubtitle(text){
      $("headerSubtitle").textContent = text;
    }

    function render(){
      const root = $("viewRoot");
      root.innerHTML = "";

      $("bottomBar").classList.remove("hidden");

      if(state.view === "search"){
        headerSubtitle("Reisesøk");
        root.appendChild(viewSearch());
        setBottomBar({
          title: "Søk reise",
          sub: "Få smart billettforslag",
          ctaText: "Vis forslag",
          enabled: true,
          onClick: () => {
            // Choose default recommended ticket
            state.ticket = ticketsCatalog[0];
            state.view = "suggestion";
            toast("Forslag klart");
            render();
          }
        });
      }

      if(state.view === "suggestion"){
        headerSubtitle("Smart forslag");
        root.appendChild(viewSuggestion());
        setBottomBar({
          title: state.ticket ? `${state.ticket.name} · ${state.ticket.price} kr` : "Velg billett",
          sub: state.ticket ? `${state.ticket.zones} · ${state.ticket.validFor}` : "Ingen valgt",
          ctaText: "Gå til betaling",
          enabled: !!state.ticket,
          onClick: () => {
            state.view = "checkout";
            render();
          }
        });
      }

      if(state.view === "checkout"){
        headerSubtitle("Utsjekk");
        root.appendChild(viewCheckout());
        setBottomBar({
          title: `Å betale: ${state.ticket.price} kr`,
          sub: "Sjekk oppsummeringen først",
          ctaText: "Betal",
          enabled: true,
          onClick: () => {
            state.ticketActiveAt = formatTimeNow();
            state.view = "ticket";
            toast("Kjøp fullført");
            render();
          }
        });
      }

      if(state.view === "ticket"){
        headerSubtitle("Din billett");
        root.appendChild(viewTicket());
        setBottomBar({
          title: "Billett aktiv",
          sub: "Vis ved kontroll",
          ctaText: "Kjøp ny",
          enabled: true,
          onClick: () => {
            state.view = "search";
            state.ticket = null;
            state.ticketActiveAt = null;
            render();
          }
        });
      }
    }

    function viewSearch(){
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <h2>Hvor skal du?</h2>
        <div class="muted small">Start i din situasjon: hvor–til–når.</div>

        <div class="input">
          <label for="from">Fra</label>
          <input id="from" value="${escapeHtml(state.from)}" />
        </div>
        <div class="input">
          <label for="to">Til</label>
          <input id="to" value="${escapeHtml(state.to)}" />
        </div>

        <div class="row" style="margin-top:10px">
          <div class="input" style="flex:1;margin:0">
            <label for="time">Når</label>
            <select id="time">
              <option ${state.time==="Nå"?"selected":""}>Nå</option>
              <option ${state.time==="Senere i dag"?"selected":""}>Senere i dag</option>
              <option ${state.time==="I morgen"?"selected":""}>I morgen</option>
            </select>
          </div>
          <div class="input" style="flex:1;margin:0">
            <label for="passenger">Reisende</label>
            <select id="passenger">
              <option ${state.passenger==="Voksen"?"selected":""}>Voksen</option>
              <option ${state.passenger==="Student"?"selected":""}>Student</option>
              <option ${state.passenger==="Barn"?"selected":""}>Barn</option>
            </select>
          </div>
        </div>

        <div class="divider"></div>
        <div class="pill">
          <b>Tips:</b> Du trenger ikke kunne soner — vi foreslår riktig billett.
        </div>
        <div class="steps" aria-label="Prosess">
          <span class="step">1. Søk reise</span>
          <span class="step">2. Få forslag</span>
          <span class="step">3. Sjekk & betal</span>
          <span class="step">4. Se gyldighet</span>
        </div>
      `;

      const from = card.querySelector("#from");
      const to = card.querySelector("#to");
      const time = card.querySelector("#time");
      const passenger = card.querySelector("#passenger");

      from.addEventListener("input", e => state.from = e.target.value);
      to.addEventListener("input", e => state.to = e.target.value);
      time.addEventListener("change", e => state.time = e.target.value);
      passenger.addEventListener("change", e => state.passenger = e.target.value);

      return wrapSection("Reisesøk", "Finn reise først – billett kommer etterpå.", card);
    }

    function viewSuggestion(){
      const wrap = document.createElement("div");

      const summary = document.createElement("div");
      summary.className = "card";
      summary.innerHTML = `
        <div class="row">
          <div class="col">
            <h2 style="margin:0">Reise: ${escapeHtml(state.from)} → ${escapeHtml(state.to)}</h2>
            <div class="muted small">Når: ${escapeHtml(state.time)} · Reisende: ${escapeHtml(state.passenger)}</div>
          </div>
          <button class="secondary" id="editTrip">Endre</button>
        </div>
      `;
      summary.querySelector("#editTrip").onclick = () => {
        state.view = "search";
        render();
      };

      const recommended = document.createElement("div");
      recommended.className = "card";
      const rec = ticketsCatalog[0];
      recommended.innerHTML = `
        <div class="tag">Anbefalt · ${rec.confidence}</div>
        <h2 style="margin-top:10px">${rec.name} · ${rec.price} kr</h2>
        <div class="pill"><b>${rec.zones}</b> · ${rec.validFor}</div>
        <div class="divider"></div>
        <div class="muted small"><span class="mono">Hvorfor?</span> ${rec.why}</div>

        <div class="kpi">
          <div class="box">
            <b>Trygghet</b>
            <span class="ok">“Riktig billett” forklart</span>
          </div>
          <div class="box">
            <b>Sonehjelp</b>
            <span>Én linje, ikke regeltekst</span>
          </div>
        </div>

        <div class="divider"></div>
        <div class="row">
          <button class="secondary" id="other">Se alternativ</button>
          <button class="primary" id="choose">Velg anbefalt</button>
        </div>
      `;

      recommended.querySelector("#choose").onclick = () => {
        state.ticket = rec;
        toast("Anbefalt valgt");
        render();
      };

      recommended.querySelector("#other").onclick = () => {
        // Toggle to alternative ticket
        const alt = ticketsCatalog[1];
        state.ticket = alt;
        toast("Alternativ valgt");
        render();
      };

      const note = document.createElement("div");
      note.className = "card";
      note.innerHTML = `
        <h2>“Hva gjelder dette egentlig?”</h2>
        <div class="muted small">
          Vi viser alltid <b>hva</b>, <b>hvor</b> og <b>til når</b> etter kjøp.
          Mindre stress ved kontroll.
        </div>
      `;

      wrap.appendChild(summary);
      wrap.appendChild(recommended);
      wrap.appendChild(note);

      return wrap;
    }

    function viewCheckout(){
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <h2>Trygg utsjekk</h2>
        <div class="muted small">Bekreft før betaling — færre feilkjøp.</div>

        <div class="divider"></div>

        <div class="row">
          <div class="col">
            <b>${state.ticket.name}</b>
            <span class="muted small">${state.ticket.zones} · ${state.ticket.validFor}</span>
          </div>
          <div><b>${state.ticket.price} kr</b></div>
        </div>

        <div class="divider"></div>

        <div class="pill"><b>Dette kjøper du:</b> 1 billett for ${escapeHtml(state.passenger)}</div>
        <div class="pill"><b>Gjelder for:</b> ${escapeHtml(state.from)} → ${escapeHtml(state.to)}</div>
        <div class="pill"><b>Gyldig:</b> Starter ved kjøp · ${state.ticket.validFor}</div>

        <div class="divider"></div>

        <div class="input">
          <label for="pay">Betalingsmåte</label>
          <select id="pay">
            <option ${state.payment==="Vipps"?"selected":""}>Vipps</option>
            <option ${state.payment==="Kort"?"selected":""}>Kort</option>
            <option ${state.payment==="Apple Pay"?"selected":""}>Apple Pay</option>
          </select>
        </div>

        <div class="divider"></div>
        <div class="muted small"><span class="mono">Sjekk:</span> Er dette riktig tur og reisende?</div>
      `;

      card.querySelector("#pay").addEventListener("change", e => state.payment = e.target.value);

      const meta = document.createElement("div");
      meta.className = "card";
      meta.innerHTML = `
        <h2>Hvorfor denne siden hjelper</h2>
        <ul class="muted small" style="margin:8px 0 0 18px; line-height:1.45">
          <li>Færre feilkjøp (alt oppsummert)</li>
          <li>Mindre tvil (hva–hvor–til når)</li>
          <li>Bedre mestring for sporadiske</li>
        </ul>
      `;

      const wrap = document.createElement("div");
      wrap.appendChild(card);
      wrap.appendChild(meta);
      return wrap;
    }

    function viewTicket(){
      const card = document.createElement("div");
      card.className = "card";
      card.innerHTML = `
        <div class="row">
          <div class="col">
            <div class="tag">Aktiv billett</div>
            <h2 style="margin-top:10px">${state.ticket.name}</h2>
            <div class="muted small">Aktivert: <span class="mono">${state.ticketActiveAt}</span></div>
          </div>
          <div style="text-align:right">
            <div class="pill" style="justify-content:flex-end"><b>${state.ticket.price} kr</b></div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="kpi">
          <div class="box">
            <b>Hva</b>
            <span>${state.ticket.name}</span>
          </div>
          <div class="box">
            <b>Hvor</b>
            <span>${state.ticket.zones}</span>
          </div>
          <div class="box">
            <b>Til når</b>
            <span>${state.ticket.validFor}</span>
          </div>
          <div class="box">
            <b>Status</b>
            <span class="ok">Gyldig nå</span>
          </div>
        </div>

        <div class="divider"></div>

        <div class="pill"><b>Kontroll:</b> Vis denne skjermen ved behov.</div>
        <div class="pill"><b>Trygghet:</b> Du har kjøpt riktig for turen.</div>
      `;

      const wrap = document.createElement("div");
      wrap.appendChild(card);

      const extra = document.createElement("div");
      extra.className = "card";
      extra.innerHTML = `
        <h2>Testspørsmål (til brukertest)</h2>
        <div class="muted small">Spør deltakeren etter fullføring:</div>
        <div class="steps">
          <span class="step">Hvor trygg er du (1–5)?</span>
          <span class="step">Hva betyr “Hvor / Til når”?</span>
          <span class="step">Hva var uklart?</span>
        </div>
      `;
      wrap.appendChild(extra);

      return wrap;
    }

    function wrapSection(title, subtitle, innerEl){
      const outer = document.createElement("div");
      const head = document.createElement("div");
      head.className = "card";
      head.innerHTML = `
        <div class="row">
          <div class="col">
            <h2 style="margin:0">${title}</h2>
            <div class="muted small">${subtitle}</div>
          </div>
          <span class="pill"><b>Mål:</b> mindre tvil</span>
        </div>
      `;
      outer.appendChild(head);
      outer.appendChild(innerEl);
      return outer;
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // Buttons
    $("resetBtn").onclick = () => {
      state.view = "search";
      state.ticket = null;
      state.ticketActiveAt = null;
      toast("Reset");
      render();
    };

    $("helpBtn").onclick = () => {
      const msg = [
        "Hjelp i prototypen:",
        "1) Søk reise",
        "2) Velg anbefalt/alternativ",
        "3) Sjekk oppsummering",
        "4) Se ‘Hva–Hvor–Til når’"
      ].join("  •  ");
      toast(msg);
    };

    // Init
    // prototype ferdigg
    render();
  </script>
</body>
</html>

